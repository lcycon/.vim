class Api::VisualizerController < ApplicationController
  def get_latest
    if params != nil && params[:count] != nil
      limit = params[:count].to_i
    else
      limit = 100
    end
    result = []
    responseString = ""
    @photos = Photo.order("photos.created_at DESC").limit(limit)
    @photos.each do |i|
      photo = {
        :url => i.url,
        :id => i.id
      }
      result << photo
      responseString += i.url + "\n" 
    end
    respond_to do |format|
      format.json {render :json => result, :callback => params[:callback]}
      format.any {render :text => responseString}
    end

  end
  def get_latest_after
    if params != nil && params[:count] != nil
      limit = params[:count].to_i
    else
      limit = 100
    end

    if params !=  nil && params[:start] != nil
      start = params[:start].to_i
    else
      return
    end

    result = []
    responseString = ""
    @photos = Photo.order("photos.created_at DESC").offset(start).limit(limit)
    @photos.each do |i|
      photo = {
        :url => i.url,
        :id => i.id
      }
      result << photo
      responseString += i.url + "\n"
    end
    respond_to do |format|
      format.json {render :json => result, :callback => params[:callback]}
      format.any {render :text => responseString}
    end
  end
end