<h1>Google Accounts</h1>

<h4><%= link_to "Import contacts from a new Gmail account", new_email_path  %></h4>

<% @emails.each do |email| %>
	<div class="google">

		<div class="picture">
		   <%= image_tag "missing.png"%>
		</div>

		<div class="info">
			<h6><%= link_to email.email + " (#{email.contacts.size} contacts)", email_contacts_path(email)  %></h6>
			<p>
				<%= link_to 'Sync contacts w/Google', import_email_contacts_path(email) %> |
				<%= link_to 'Destroy', email, :method => :delete, :confirm => "Are you sure? All contacts associated with this account will be destroyed!" %>
			</p>
		</div>
		<br style="clear:both;"/>
	</div>
<% end %>


<% if @email %>
<hr/>
	<h1>
		<span class="highlight"><%= @email.email + " (#{@email.contacts.size} contacts)" %></span> 
		| <%= link_to "New contact", new_email_contact_path(@email) %>
	</h1>
	<%= form_tag(email_contacts_path(@email), :method => :get) do %>	
		<p>
			<%= radio_button_tag 'email_or_name', 'email_address', default_email_contact_serach_params(params[:email_or_name], 'email_address') %> 
			<%= label :email_or_name, 'email_address' %> |
			<%= radio_button_tag 'email_or_name', 'name', default_email_contact_serach_params(params[:email_or_name], 'name')  %> 
			<%= label :email_or_name, 'name' %>
		</p>
		<p>
			<%= text_field_tag :term, {}, :value => params[:term], :style => "width:400px;"%>
			<%= submit_tag "Search", :disable_with => "Searching..."%>
		</p>
	<% end %>

	<% if @contacts.blank? %>
		<h3>No contacts were found!</h3>
	<% else %>
		<% @contacts.each do |contact| %>
			<div class="google">
				<div class="picture">
				   <%= image_tag "missing.png"%>
				</div>
				<div class="info">
					<p>
						<%= contact.email_address%> | 
						<%= link_to 'edit', edit_email_contact_path(@email, contact) %> | 
						<%= link_to 'destroy', email_contact_path(@email, contact), :method => :delete %>
						<br/>
						<%= contact.name %>
					</p>
				</div>
				<br style="clear:both;"/>
			</div>
		<% end %>
	<% end %>
<% end %>
